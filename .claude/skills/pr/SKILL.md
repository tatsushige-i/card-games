---
name: pr
description: 変更をコミットし、feature ブランチをプッシュして PR を作成する。完了後はローカルブランチを削除して main に戻る。
argument-hint: "[コミットメッセージ(省略可)]"
---

# PR 作成スキル

現在の feature ブランチの変更をコミット・プッシュし、GitHub PR を作成した後、ローカルブランチを削除して main に戻る。

## 前提条件

- 現在 feature ブランチにいること（main ブランチでは実行しない）
- コミット対象の変更（未ステージまたはステージ済み）があること

## 実行プロセス

### Step 1: 状態確認

1. 現在のブランチ名を取得する
2. `main` ブランチにいる場合は **エラーとして中止** し、feature ブランチを作成するよう案内する
3. `git status` で変更があることを確認する。変更がない場合は **エラーとして中止** する
4. `git diff` と `git diff --staged` で変更内容を把握する
5. `git log` で直近のコミットメッセージのスタイルを確認する

### Step 2: コミット

1. 変更内容を分析し、適切なコミットメッセージを作成する
   - `$ARGUMENTS` が指定されている場合はそれをコミットメッセージとして使用する
   - 未指定の場合は変更内容から自動生成する（`feat:`, `fix:`, `chore:`, `refactor:` 等のプレフィックス付き）
2. 関連ファイルを個別にステージングする（`git add <file>` — `.env` 等の機密ファイルは除外）
3. コミットを作成する

### Step 3: プッシュ

1. `git push -u origin <branch-name>` でリモートにプッシュする

### Step 4: PR 作成

1. `gh pr create` で PR を作成する
   - タイトル: コミットメッセージまたは変更内容の要約（70文字以内）
   - 本文: Summary（箇条書き）+ Test plan
2. `gh` コマンドが利用できない場合は、PR 作成用の GitHub URL を提示する

### Step 5: クリーンアップ

1. `git switch main` で main ブランチに戻る
2. `git branch -d <branch-name>` でローカルの feature ブランチを削除する

> **⚠️ チーム開発での注意:** このステップは個人開発向けの運用。複数人のプロジェクトでは、PR 作成後にレビュー・修正・再プッシュのサイクルが発生するため、PR がマージされるまでローカルの feature ブランチを削除すべきではない。チーム開発で使用する場合は、このステップをスキップするか、マージ後に実行するよう変更すること。

### Step 6: 完了報告

PR の URL をユーザーに報告する。
